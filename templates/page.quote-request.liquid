<!--
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  RFQ Page - Full Version (layout similar to reference)
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  
  Features:
  1. 3D model upload & preview
  2. Full configuration options (material, finish, tolerance, etc.)
  3. Submit RFQ (calls submit-quote API)
  4. Redirect to "My Quotes" to track status
-->

<div class="quote-request-container">
  <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü -->
  <div class="main-content">
    
    <!-- Â∑¶‰æßÔºö3D Ê®°Âûã‰∏ä‰º†ÂíåÈ¢ÑËßà -->
    <div class="upload-section">
      <h2>üìÅ Upload 3D Files</h2>
      
      <!-- 3D È¢ÑËßàÂå∫Âüü -->
      <div class="model-viewer-container">
        <div id="model-viewer" class="model-viewer">
          <div class="viewer-placeholder">
            <div class="viewer-icon">üéØ</div>
            <p>Your 3D preview will appear after upload</p>
          </div>
        </div>
        
        <!-- È¢ÑËßàÂ∑•ÂÖ∑ÊåâÈíÆ -->
        <div class="viewer-tools">
          <button class="tool-btn" title="View">
            <span class="icon">üëÅÔ∏è</span>
            <span class="text">View</span>
          </button>
          <button class="tool-btn" title="Measure">
            <span class="icon">üìè</span>
            <span class="text">Measure</span>
          </button>
          <button class="tool-btn" title="Annotate">
            <span class="icon">‚úèÔ∏è</span>
            <span class="text">Annotate</span>
          </button>
          <button class="tool-btn" title="Export">
            <span class="icon">üì§</span>
            <span class="text">Export</span>
          </button>
        </div>
      </div>
      
      <!-- ‰∏ä‰º†Âå∫Âüü -->
      <div class="upload-area" id="dropzone">
        <div class="upload-info">
          <div class="upload-icon">üìÅ</div>
          <h3>Upload your CAD files</h3>
          <p class="supported-formats">Supported: STP/STEP, plus matching 2D drawings (DWG/DXF/PDF)</p>
          <p class="file-limit">Up to 20 files per upload; max 100 MB per file</p>
        </div>
        <input type="file" id="file-input" accept=".step,.stp,.stl,.obj,.3ds,.fbx,.dae,.gltf,.glb,.dwg,.dxf,.pdf" style="display: none;" multiple>
        <button type="button" class="upload-btn" onclick="document.getElementById('file-input').click()">
          Choose files
        </button>
      </div>
      
      <!-- Êñá‰ª∂È¢ÑËßà -->
      <div id="file-preview" class="file-preview" style="display: none;">
        <h3>Selected files</h3>
        <div id="file-list"></div>
      </div>
    </div>
    
    <!-- Âè≥‰æßÔºöÈÖçÁΩÆÈÄâÈ°π -->
    <div class="config-section">
      <h2>‚öôÔ∏è Specifications</h2>
      
      <form id="quote-form" class="config-form">
        
        <!-- Âçï‰ΩçÈÄâÊã© -->
        <div class="form-group">
          <label>Units</label>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="unit" value="mm" checked>
              <span class="radio-text">Millimeters (mm)</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="unit" value="in">
              <span class="radio-text">Inches (in)</span>
            </label>
          </div>
        </div>
        
        <!-- ÊùêË¥®ÈÄâÊã© -->
        <div class="form-group">
          <label for="material">Material *</label>
          <select id="material" name="material" required>
            <option value="">Select a material</option>
            <option value="PLA">PLA</option>
            <option value="ABS" selected>ABS</option>
            <option value="PETG">PETG</option>
            <option value="Nylon">Nylon</option>
            <option value="Resin">Resin</option>
            <option value="Metal">Metal</option>
            <option value="Other">Other</option>
          </select>
        </div>
        
        <!-- È¢úËâ≤ÂíåË°®Èù¢ -->
        <div class="form-group">
          <label for="color">Color / Finish</label>
          <select id="color" name="color">
            <option value="Natural" selected>Natural</option>
            <option value="White">White</option>
            <option value="Black">Black</option>
            <option value="Clear">Clear</option>
            <option value="Other">Other</option>
          </select>
        </div>
        
        <!-- Á≤æÂ∫¶Á≠âÁ∫ß -->
        <div class="form-group">
          <label for="precision">Precision</label>
          <select id="precision" name="precision">
            <option value="Standard (¬±0.1mm)" selected>Standard (¬±0.1mm)</option>
            <option value="High (¬±0.05mm)">High (¬±0.05mm)</option>
            <option value="Ultra (¬±0.02mm)">Ultra (¬±0.02mm)</option>
          </select>
        </div>
        
        <!-- ÂÖ¨Â∑ÆÊ†áÂáÜ -->
        <div class="form-group">
          <label for="tolerance">Tolerance Standard</label>
          <select id="tolerance" name="tolerance">
            <option value="GB/T 1804-2000 m" selected>GB/T 1804-2000 m</option>
            <option value="GB/T 1804-2000 f">GB/T 1804-2000 f</option>
            <option value="GB/T 1804-2000 c">GB/T 1804-2000 c</option>
          </select>
        </div>
        
        <!-- ÊúÄÂ∞èÁ≤óÁ≥ôÂ∫¶ -->
        <div class="form-group">
          <label for="roughness">Surface Roughness</label>
          <select id="roughness" name="roughness">
            <option value="Ra3.2" selected>Ra3.2</option>
            <option value="Ra1.6">Ra1.6</option>
            <option value="Ra0.8">Ra0.8</option>
            <option value="Ra0.4">Ra0.4</option>
          </select>
        </div>
        
        <!-- Ëû∫Á∫π -->
        <div class="form-group">
          <label>Threads?</label>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="hasThread" value="yes">
              <span class="radio-text">Yes</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="hasThread" value="no" checked>
              <span class="radio-text">No</span>
            </label>
          </div>
        </div>
        
        <!-- Ë£ÖÈÖçÊ†áËÆ∞ -->
        <div class="form-group">
          <label>Assembly features?</label>
          <div class="radio-group">
            <label class="radio-item">
              <input type="radio" name="hasAssembly" value="yes">
              <span class="radio-text">Yes</span>
            </label>
            <label class="radio-item">
              <input type="radio" name="hasAssembly" value="no" checked>
              <span class="radio-text">No</span>
            </label>
          </div>
        </div>
        
        <!-- Áº©Êîæ -->
        <div class="form-group">
          <label for="scale">Scale: <span id="scale-value">100%</span></label>
          <input type="range" id="scale" name="scale" min="10" max="500" value="100" class="slider">
        </div>
        
        <!-- Êï∞Èáè -->
        <div class="form-group">
          <label for="quantity">Quantity *</label>
          <div class="quantity-input">
            <button type="button" class="qty-btn" onclick="changeQuantity(-1)">-</button>
            <input type="number" id="quantity" name="quantity" min="1" value="1" required>
            <button type="button" class="qty-btn" onclick="changeQuantity(1)">+</button>
          </div>
        </div>
        
        <!-- ÂÆ¢Êà∑‰ø°ÊÅØ -->
        <div class="form-group">
          <label for="customer-name">Name</label>
          <input type="text" id="customer-name" name="customer-name" placeholder="Enter your name">
        </div>
        
        <div class="form-group">
          <label for="customer-email">Email *</label>
          <input type="email" id="customer-email" name="customer-email" placeholder="We‚Äôll send your quote to this email" required>
          <span class="hint">We‚Äôll notify you by email when your quote is ready.</span>
        </div>
        
        <!-- Â§áÊ≥® -->
        <div class="form-group">
          <label for="note">Notes</label>
          <textarea id="note" name="note" rows="4" placeholder="Add any special requirements (e.g., tolerances, finish, lead time)..." maxlength="200"></textarea>
          <div class="char-count">
            <span id="char-count">0</span>/200
          </div>
        </div>
        
      </form>
    </div>
  </div>
  
  <!-- Â∫ïÈÉ®Âå∫Âüü -->
  <div class="bottom-section">
    
    <!-- ÈáçË¶ÅÊèêÈÜí -->
    <div class="warning-box">
      <div class="warning-icon">‚ö†Ô∏è</div>
      <div class="warning-text">
        Important: If your part includes threads or assembly features, please upload the matching 2D drawing (DWG/DXF/PDF) for each 3D file so we can quote accurately.
      </div>
    </div>
    
    <!-- Êèê‰∫§ÊåâÈíÆ -->
    <div class="submit-section">
      <button type="button" id="submit-btn" class="submit-btn" onclick="submitQuote()" disabled>
        <span id="btn-text">Request a Quote</span>
        <span id="btn-loading" style="display: none;">
          <span class="spinner"></span> Submitting...
        </span>
      </button>
      
      <!-- ‰∫§‰ªòÂíåË¥®Èáè‰ø°ÊÅØ -->
      <div class="info-cards">
        <div class="info-card">
          <span class="info-icon">‚è∞</span>
          <span class="info-text">Estimated lead time: 3‚Äì5 business days</span>
        </div>
        <div class="info-card">
          <span class="info-icon">‚úÖ</span>
          <span class="info-text">Quality assurance: 100% inspection</span>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ÊàêÂäüÊ∂àÊÅØ -->
  <div id="success-message" class="success-message" style="display: none;">
    <div class="success-icon">
      <div class="checkmark">
        <div class="checkmark-stem"></div>
        <div class="checkmark-kick"></div>
      </div>
    </div>
    <h3>RFQ Submitted!</h3>
    <p id="success-text"></p>
    <div class="success-actions">
      <button class="btn-primary" onclick="viewQuote()">View Quote</button>
      <button class="btn-secondary" onclick="closeSuccessMessage()">Submit Another</button>
    </div>
  </div>
  
  <!-- ÈîôËØØÊ∂àÊÅØ -->
  <div id="error-message" class="error-message" style="display: none;">
    <div class="error-icon">‚ùå</div>
    <h3>Submission Failed</h3>
    <p id="error-text"></p>
    <button class="btn-secondary" onclick="hideError()">Close</button>
  </div>
</div>

<style>
  .quote-request-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #f8f9fa;
    min-height: 100vh;
  }
  
  .main-content {
    display: grid;
    grid-template-columns: 1fr 400px;
    gap: 30px;
    margin-bottom: 30px;
  }
  
  /* Â∑¶‰æß‰∏ä‰º†Âå∫Âüü */
  .upload-section {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  .upload-section h2 {
    margin: 0 0 20px 0;
    font-size: 20px;
    color: #333;
  }
  
  /* 3D È¢ÑËßàÂå∫Âüü */
  .model-viewer-container {
    position: relative;
    margin-bottom: 25px;
  }
  
  .model-viewer {
    width: 100%;
    height: 400px;
    background: #f5f5f5;
    border: 2px dashed #ddd;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }
  
  .viewer-placeholder {
    text-align: center;
    color: #666;
  }
  
  .viewer-icon {
    font-size: 48px;
    margin-bottom: 10px;
  }
  
  .viewer-tools {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  
  .tool-btn {
    background: white;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    transition: all 0.3s;
  }
  
  .tool-btn:hover {
    background: #f0f0f0;
  }
  
  .tool-btn .icon {
    font-size: 14px;
  }
  
  /* ‰∏ä‰º†Âå∫Âüü */
  .upload-area {
    border: 2px dashed #ddd;
    border-radius: 12px;
    padding: 40px 20px;
    text-align: center;
    background: #fafafa;
    transition: all 0.3s;
  }
  
  .upload-area:hover {
    border-color: #667eea;
    background: #f0f0ff;
  }
  
  .upload-area.dragover {
    border-color: #667eea;
    background: #e6e6ff;
  }
  
  .upload-icon {
    font-size: 48px;
    margin-bottom: 15px;
  }
  
  .upload-area h3 {
    margin: 0 0 10px 0;
    font-size: 18px;
    color: #333;
  }
  
  .supported-formats {
    margin: 5px 0;
    color: #666;
    font-size: 14px;
  }
  
  .file-limit {
    margin: 5px 0 20px 0;
    color: #999;
    font-size: 12px;
  }
  
  .upload-btn {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 12px 30px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
  }
  
  .upload-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
  }
  
  /* Êñá‰ª∂È¢ÑËßà */
  .file-preview {
    margin-top: 20px;
  }
  
  .file-preview h3 {
    margin: 0 0 15px 0;
    font-size: 16px;
    color: #333;
  }
  
  #file-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  
  .file-item {
    display: flex;
    align-items: center;
    padding: 12px;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #e0e0e0;
  }
  
  .file-icon {
    font-size: 24px;
    margin-right: 12px;
  }
  
  .file-info {
    flex: 1;
  }
  
  .file-name {
    font-weight: 600;
    color: #333;
    margin-bottom: 4px;
  }
  
  .file-size {
    color: #666;
    font-size: 12px;
  }
  
  .remove-file {
    background: #f44336;
    color: white;
    border: none;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    cursor: pointer;
    font-size: 14px;
  }
  
  /* Âè≥‰æßÈÖçÁΩÆÂå∫Âüü */
  .config-section {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    height: fit-content;
  }
  
  .config-section h2 {
    margin: 0 0 20px 0;
    font-size: 20px;
    color: #333;
  }
  
  .config-form {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }
  
  .form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  
  .form-group label {
    font-weight: 600;
    color: #333;
    font-size: 14px;
  }
  
  .form-group input,
  .form-group select,
  .form-group textarea {
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
    font-family: inherit;
  }
  
  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    outline: none;
    border-color: #667eea;
  }
  
  /* ÂçïÈÄâÊåâÈíÆÁªÑ */
  .radio-group {
    display: flex;
    gap: 15px;
  }
  
  .radio-item {
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
  }
  
  .radio-item input[type="radio"] {
    margin: 0;
  }
  
  .radio-text {
    font-weight: normal;
  }
  
  /* Êï∞ÈáèËæìÂÖ• */
  .quantity-input {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  .qty-btn {
    width: 32px;
    height: 32px;
    border: 1px solid #ddd;
    background: white;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .qty-btn:hover {
    background: #f0f0f0;
  }
  
  .quantity-input input {
    width: 80px;
    text-align: center;
  }
  
  /* ÊªëÂùó */
  .slider {
    width: 100%;
    height: 6px;
    background: #ddd;
    border-radius: 3px;
    outline: none;
    -webkit-appearance: none;
  }
  
  .slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 20px;
    height: 20px;
    background: #667eea;
    border-radius: 50%;
    cursor: pointer;
  }
  
  .slider::-moz-range-thumb {
    width: 20px;
    height: 20px;
    background: #667eea;
    border-radius: 50%;
    cursor: pointer;
    border: none;
  }
  
  /* Â≠óÁ¨¶ËÆ°Êï∞ */
  .char-count {
    text-align: right;
    font-size: 12px;
    color: #666;
  }
  
  .hint {
    font-size: 12px;
    color: #666;
  }
  
  /* Â∫ïÈÉ®Âå∫Âüü */
  .bottom-section {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  /* Ë≠¶ÂëäÊ°Ü */
  .warning-box {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
  }
  
  .warning-icon {
    font-size: 20px;
    flex-shrink: 0;
  }
  
  .warning-text {
    color: #856404;
    font-size: 14px;
    line-height: 1.5;
  }
  
  /* Êèê‰∫§Âå∫Âüü */
  .submit-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
  }
  
  .submit-btn {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 15px 40px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    min-width: 200px;
  }
  
  .submit-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
  }
  
  .submit-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
    transform: none;
  }
  
  /* ‰ø°ÊÅØÂç°Áâá */
  .info-cards {
    display: flex;
    gap: 30px;
  }
  
  .info-card {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #28a745;
    font-size: 14px;
  }
  
  .info-icon {
    font-size: 16px;
  }
  
  /* Âä†ËΩΩÂä®Áîª */
  .spinner {
    display: inline-block;
    width: 14px;
    height: 14px;
    border: 2px solid white;
    border-top: 2px solid transparent;
    border-radius: 50%;
    animation: spin 0.6s linear infinite;
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  /* ÊàêÂäü/ÈîôËØØÊ∂àÊÅØ */
  .success-message,
  .error-message {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    padding: 48px 40px;
    border-radius: 20px;
    box-shadow: 
      0 20px 60px rgba(0,0,0,0.15),
      0 0 0 1px rgba(255,255,255,0.05);
    text-align: center;
    z-index: 1000;
    max-width: 480px;
    width: 90%;
    backdrop-filter: blur(10px);
    animation: successModalIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  
  @keyframes successModalIn {
    0% {
      opacity: 0;
      transform: translate(-50%, -50%) scale(0.8);
    }
    100% {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
  }
  
  .success-message {
    border: 2px solid #e8f5e8;
    background: linear-gradient(135deg, #ffffff 0%, #f0f9f0 100%);
  }
  
  .success-icon {
    position: relative;
    width: 80px;
    height: 80px;
    margin: 0 auto 24px auto;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .checkmark {
    position: relative;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    animation: checkmarkPop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }
  
  @keyframes checkmarkPop {
    0% {
      transform: scale(0);
    }
    50% {
      transform: scale(1.2);
    }
    100% {
      transform: scale(1);
    }
  }
  
  .checkmark-stem {
    position: absolute;
    width: 3px;
    height: 16px;
    background: white;
    border-radius: 2px;
    transform: rotate(45deg);
    left: 50%;
    top: 50%;
    margin-left: -1px;
    margin-top: -8px;
  }
  
  .checkmark-kick {
    position: absolute;
    width: 3px;
    height: 8px;
    background: white;
    border-radius: 2px;
    transform: rotate(-45deg);
    left: 50%;
    top: 50%;
    margin-left: -6px;
    margin-top: -2px;
  }
  
  .error-icon {
    font-size: 64px;
    margin-bottom: 20px;
  }
  
  .success-message h3,
  .error-message h3 {
    margin: 0 0 16px 0;
    color: #1f2937;
    font-size: 24px;
    font-weight: 600;
    letter-spacing: -0.025em;
  }
  
  .success-message p,
  .error-message p {
    margin: 0 0 32px 0;
    color: #6b7280;
    line-height: 1.6;
    font-size: 16px;
  }
  
  .success-actions {
    display: flex;
    gap: 12px;
    justify-content: center;
    flex-wrap: wrap;
  }
  
  .btn-primary,
  .btn-secondary {
    padding: 14px 28px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    min-width: 120px;
  }
  
  .btn-primary {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    box-shadow: 0 4px 14px rgba(16, 185, 129, 0.3);
  }
  
  .btn-primary:hover {
    background: linear-gradient(135deg, #059669 0%, #047857 100%);
    box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
    transform: translateY(-2px);
  }
  
  .btn-secondary {
    background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
    color: #374151;
    border: 1px solid #d1d5db;
  }
  
  .btn-secondary:hover {
    background: linear-gradient(135deg, #e5e7eb 0%, #d1d5db 100%);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
  
  /* ÂìçÂ∫îÂºèËÆæËÆ° */
  @media (max-width: 1024px) {
    .main-content {
      grid-template-columns: 1fr;
      gap: 20px;
    }
    
    .config-section {
      order: -1;
    }
  }
  
  @media (max-width: 768px) {
    .quote-request-container {
      padding: 15px;
    }
    
    .upload-section,
    .config-section,
    .bottom-section {
      padding: 20px;
    }
    
    .model-viewer {
      height: 300px;
    }
    
    .viewer-tools {
      flex-direction: row;
      top: auto;
      bottom: 10px;
      right: 10px;
    }
    
    .tool-btn .text {
      display: none;
    }
    
    .info-cards {
      flex-direction: column;
      gap: 15px;
    }
  }
</style>

<!-- Three.js for 3D preview -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/STLLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/OBJLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

<script>
  const API_BASE = 'https://shopify-v587.vercel.app/api';  // ‚Üê ËØ∑‰øÆÊîπ‰∏∫‰Ω†ÁöÑÂÆûÈôÖ Vercel ÂüüÂêç
  
  let selectedFiles = [];
  let quoteResult = null;
  
  // 3DÊü•ÁúãÂô®Áõ∏ÂÖ≥ÂèòÈáè
  let scene = null;
  let camera = null;
  let renderer = null;
  let controls = null;
  let currentModel = null;
  
  // ÂàùÂßãÂåñ
  document.addEventListener('DOMContentLoaded', function() {
    init3DViewer();
    initFileUpload();
    initForm();
    updateSubmitButton();
  });
  
  /**
   * Initialize 3D viewer
   */
  function init3DViewer() {
    const viewer = document.getElementById('model-viewer');
    if (!viewer) return;
    
    // ÂàõÂª∫Âú∫ÊôØ
    scene = new THREE.Scene();
    scene.background = new THREE.Color(0xf5f5f5);
    
    // ÂàõÂª∫Áõ∏Êú∫
    camera = new THREE.PerspectiveCamera(75, viewer.clientWidth / viewer.clientHeight, 0.1, 1000);
    camera.position.set(0, 0, 50);
    
    // ÂàõÂª∫Ê∏≤ÊüìÂô®
    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(viewer.clientWidth, viewer.clientHeight);
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.PCFSoftShadowMap;
    
    // Replace placeholder with renderer
    viewer.innerHTML = '';
    viewer.appendChild(renderer.domElement);
    
    // Ê∑ªÂä†ÂÖâÊ∫ê
    const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
    scene.add(ambientLight);
    
    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
    directionalLight.position.set(50, 50, 50);
    directionalLight.castShadow = true;
    scene.add(directionalLight);
    
    // Ê∑ªÂä†ËΩ®ÈÅìÊéßÂà∂Âô®
    if (typeof THREE.OrbitControls !== 'undefined') {
      controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.05;
    }
    
    // Ê∏≤ÊüìÂæ™ÁéØ
    animate();
    
    // Á™óÂè£Â§ßÂ∞èË∞ÉÊï¥
    window.addEventListener('resize', onWindowResize);
  }
  
  /**
   * Render loop
   */
  function animate() {
    requestAnimationFrame(animate);
    
    if (controls) {
      controls.update();
    }
    
    if (renderer && scene && camera) {
      renderer.render(scene, camera);
    }
  }
  
  /**
   * Resize handling
   */
  function onWindowResize() {
    const viewer = document.getElementById('model-viewer');
    if (!viewer || !camera || !renderer) return;
    
    camera.aspect = viewer.clientWidth / viewer.clientHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(viewer.clientWidth, viewer.clientHeight);
  }
  
  /**
   * Load 3D model
   */
  async function load3DModel(file) {
    if (!scene || !renderer) return;
    
    // Ê∏ÖÈô§ÂΩìÂâçÊ®°Âûã
    if (currentModel) {
      scene.remove(currentModel);
      currentModel = null;
    }
    
    const fileName = file.name.toLowerCase();
    
    try {
      if (fileName.endsWith('.stl')) {
        await loadSTLModel(file);
      } else if (fileName.endsWith('.obj')) {
        await loadOBJModel(file);
      } else if (fileName.endsWith('.step') || fileName.endsWith('.stp')) {
        // STEP: show info placeholder (requires CAD software)
        showStepFileInfo(file);
      } else {
        showUnsupportedFileInfo(file);
      }
    } catch (error) {
      console.error('Failed to load 3D model:', error);
      showErrorInfo('Model load failed: ' + error.message);
    }
  }
  
  /**
   * Load STL model
   */
  function loadSTLModel(file) {
    return new Promise((resolve, reject) => {
      const loader = new THREE.STLLoader();
      const url = URL.createObjectURL(file);
      
      loader.load(
        url,
        function (geometry) {
          // ËÆ°ÁÆóÂá†‰Ωï‰Ωì‰∏≠ÂøÉ
          geometry.computeBoundingBox();
          const center = geometry.boundingBox.getCenter(new THREE.Vector3());
          geometry.translate(-center.x, -center.y, -center.z);
          
          // ÂàõÂª∫ÊùêË¥®
          const material = new THREE.MeshPhongMaterial({
            color: 0x888888,
            shininess: 100,
            side: THREE.DoubleSide
          });
          
          // ÂàõÂª∫ÁΩëÊ†º
          currentModel = new THREE.Mesh(geometry, material);
          currentModel.castShadow = true;
          currentModel.receiveShadow = true;
          
          scene.add(currentModel);
          
          // Ë∞ÉÊï¥Áõ∏Êú∫‰ΩçÁΩÆ
          const box = new THREE.Box3().setFromObject(currentModel);
          const size = box.getSize(new THREE.Vector3());
          const maxDim = Math.max(size.x, size.y, size.z);
          const fov = camera.fov * (Math.PI / 180);
          let cameraZ = Math.abs(maxDim / 2 / Math.tan(fov / 2));
          cameraZ *= 1.5; // Ê∑ªÂä†‰∏Ä‰∫õËæπË∑ù
          
          camera.position.set(cameraZ, cameraZ, cameraZ);
          camera.lookAt(0, 0, 0);
          
          if (controls) {
            controls.target.set(0, 0, 0);
            controls.update();
          }
          
          URL.revokeObjectURL(url);
          resolve();
        },
        function (progress) {
          console.log('STL load progress:', (progress.loaded / progress.total * 100) + '%');
        },
        function (error) {
          URL.revokeObjectURL(url);
          reject(error);
        }
      );
    });
  }
  
  /**
   * Load OBJ model
   */
  function loadOBJModel(file) {
    return new Promise((resolve, reject) => {
      const loader = new THREE.OBJLoader();
      const url = URL.createObjectURL(file);
      
      loader.load(
        url,
        function (object) {
          // ËÆ°ÁÆóÂØπË±°‰∏≠ÂøÉ
          const box = new THREE.Box3().setFromObject(object);
          const center = box.getCenter(new THREE.Vector3());
          object.position.sub(center);
          
          // ËÆæÁΩÆÊùêË¥®
          object.traverse(function (child) {
            if (child instanceof THREE.Mesh) {
              child.material = new THREE.MeshPhongMaterial({
                color: 0x888888,
                shininess: 100
              });
              child.castShadow = true;
              child.receiveShadow = true;
            }
          });
          
          currentModel = object;
          scene.add(currentModel);
          
          // Ë∞ÉÊï¥Áõ∏Êú∫‰ΩçÁΩÆ
          const size = box.getSize(new THREE.Vector3());
          const maxDim = Math.max(size.x, size.y, size.z);
          const fov = camera.fov * (Math.PI / 180);
          let cameraZ = Math.abs(maxDim / 2 / Math.tan(fov / 2));
          cameraZ *= 1.5;
          
          camera.position.set(cameraZ, cameraZ, cameraZ);
          camera.lookAt(0, 0, 0);
          
          if (controls) {
            controls.target.set(0, 0, 0);
            controls.update();
          }
          
          URL.revokeObjectURL(url);
          resolve();
        },
        function (progress) {
          console.log('OBJ load progress:', (progress.loaded / progress.total * 100) + '%');
        },
        function (error) {
          URL.revokeObjectURL(url);
          reject(error);
        }
      );
    });
  }
  
  /**
   * Show STEP file info
   */
  function showStepFileInfo(file) {
    const viewer = document.getElementById('model-viewer');
    if (!viewer) return;
    
    viewer.innerHTML = `
      <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; text-align: center; color: #666;">
        <div style="font-size: 48px; margin-bottom: 20px;">üìê</div>
        <h3 style="margin: 0 0 10px 0; color: #333;">STEP uploaded</h3>
        <p style="margin: 0; font-size: 14px;">File: ${file.name}</p>
        <p style="margin: 10px 0 0 0; font-size: 12px; color: #999;">STEP preview requires CAD software</p>
      </div>
    `;
  }
  
  /**
   * Show unsupported file info
   */
  function showUnsupportedFileInfo(file) {
    const viewer = document.getElementById('model-viewer');
    if (!viewer) return;
    
    viewer.innerHTML = `
      <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; text-align: center; color: #666;">
        <div style="font-size: 48px; margin-bottom: 20px;">üìÑ</div>
        <h3 style="margin: 0 0 10px 0; color: #333;">File uploaded</h3>
        <p style="margin: 0; font-size: 14px;">File: ${file.name}</p>
        <p style="margin: 10px 0 0 0; font-size: 12px; color: #999;">3D preview is not available for this format</p>
      </div>
    `;
  }
  
  /**
   * Show error info
   */
  function showErrorInfo(message) {
    const viewer = document.getElementById('model-viewer');
    if (!viewer) return;
    
    viewer.innerHTML = `
      <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; text-align: center; color: #f44336;">
        <div style="font-size: 48px; margin-bottom: 20px;">‚ö†Ô∏è</div>
        <h3 style="margin: 0 0 10px 0; color: #f44336;">Load failed</h3>
        <p style="margin: 0; font-size: 14px;">${message}</p>
      </div>
    `;
  }
  
  /**
   * Initialize file upload
   */
  function initFileUpload() {
    const dropzone = document.getElementById('dropzone');
    const fileInput = document.getElementById('file-input');
    
    // ÁÇπÂáª‰∏ä‰º†Âå∫Âüü
    dropzone.addEventListener('click', function(e) {
      if (e.target.tagName !== 'BUTTON') {
        fileInput.click();
      }
    });
    
    // Êñá‰ª∂ÈÄâÊã©
    fileInput.addEventListener('change', function(e) {
      if (e.target.files.length > 0) {
        handleFiles(Array.from(e.target.files));
      }
    });
    
    // ÊãñÊãΩ‰∏ä‰º†
    dropzone.addEventListener('dragover', function(e) {
      e.preventDefault();
      dropzone.classList.add('dragover');
    });
    
    dropzone.addEventListener('dragleave', function(e) {
      e.preventDefault();
      dropzone.classList.remove('dragover');
    });
    
    dropzone.addEventListener('drop', function(e) {
      e.preventDefault();
      dropzone.classList.remove('dragover');
      
      if (e.dataTransfer.files.length > 0) {
        handleFiles(Array.from(e.dataTransfer.files));
      }
    });
    
    // Áº©ÊîæÊªëÂùó
    const scaleSlider = document.getElementById('scale');
    const scaleValue = document.getElementById('scale-value');
    scaleSlider.addEventListener('input', function() {
      scaleValue.textContent = this.value + '%';
    });
    
    // Notes character counter
    const noteTextarea = document.getElementById('note');
    const charCount = document.getElementById('char-count');
    noteTextarea.addEventListener('input', function() {
      charCount.textContent = this.value.length;
    });
  }
  
  /**
   * Initialize form
   */
  function initForm() {
    const form = document.getElementById('quote-form');
    
    // ÁõëÂê¨ÊâÄÊúâË°®ÂçïÂèòÂåñ
    form.addEventListener('change', updateSubmitButton);
    form.addEventListener('input', updateSubmitButton);
    
    // Autofill customer info
    const customerEmail = getCustomerEmail();
    if (customerEmail) {
      document.getElementById('customer-email').value = customerEmail;
    }
    
    const customerName = getCustomerName();
    if (customerName) {
      document.getElementById('customer-name').value = customerName;
    }
  }
  
  /**
   * Handle selected files
   */
  async function handleFiles(files) {
    // Validate files
    const validFiles = files.filter(file => {
      const validExtensions = ['.step', '.stp', '.stl', '.obj', '.3ds', '.fbx', '.dae', '.gltf', '.glb', '.dwg', '.dxf', '.pdf'];
      const fileName = file.name.toLowerCase();
      const isValid = validExtensions.some(ext => fileName.endsWith(ext));
      
      if (!isValid) {
        alert(`Unsupported file format: ${file.name}`);
        return false;
      }
      
      // È™åËØÅÊñá‰ª∂Â§ßÂ∞èÔºà100MBÔºâ
      const maxSize = 100 * 1024 * 1024;
      if (file.size > maxSize) {
        alert(`File too large: ${file.name} (${formatFileSize(file.size)})`);
        return false;
      }
      
      return true;
    });
    
    // Append to selected files
    selectedFiles = [...selectedFiles, ...validFiles];
    
    // Update preview list
    updateFilePreview();
    updateSubmitButton();
    
    // Preview the first uploaded file
    if (validFiles.length > 0) {
      const firstFile = validFiles[0];
      await load3DModel(firstFile);
    }
  }
  
  /**
   * Update file preview
   */
  function updateFilePreview() {
    const filePreview = document.getElementById('file-preview');
    const fileList = document.getElementById('file-list');
    
    if (selectedFiles.length === 0) {
      filePreview.style.display = 'none';
      return;
    }
    
    filePreview.style.display = 'block';
    
    fileList.innerHTML = selectedFiles.map((file, index) => `
      <div class="file-item" onclick="selectFileForPreview(${index})">
        <div class="file-icon">${getFileIcon(file.name)}</div>
        <div class="file-info">
          <div class="file-name">${file.name}</div>
          <div class="file-size">${formatFileSize(file.size)}</div>
        </div>
        <button class="remove-file" onclick="event.stopPropagation(); removeFile(${index})">‚úï</button>
      </div>
    `).join('');
  }
  
  /**
   * Select file for preview
   */
  async function selectFileForPreview(index) {
    if (index >= 0 && index < selectedFiles.length) {
      const file = selectedFiles[index];
      await load3DModel(file);
      
      // Highlight selected file
      const fileItems = document.querySelectorAll('.file-item');
      fileItems.forEach((item, i) => {
        if (i === index) {
          item.style.backgroundColor = '#e3f2fd';
          item.style.borderColor = '#2196f3';
        } else {
          item.style.backgroundColor = '#f8f9fa';
          item.style.borderColor = '#e0e0e0';
        }
      });
    }
  }
  
  /**
   * Remove file
   */
  function removeFile(index) {
    selectedFiles.splice(index, 1);
    updateFilePreview();
    updateSubmitButton();
  }
  
  /**
   * Get file icon
   */
  function getFileIcon(fileName) {
    const ext = fileName.toLowerCase().split('.').pop();
    const iconMap = {
      'step': 'üìê', 'stp': 'üìê', 'stl': 'üî∫', 'obj': 'üì¶',
      '3ds': 'üéØ', 'fbx': 'üéÆ', 'dae': 'üåü', 'gltf': '‚ú®', 'glb': '‚ú®',
      'dwg': 'üìè', 'dxf': 'üìê', 'pdf': 'üìÑ'
    };
    return iconMap[ext] || 'üìÑ';
  }
  
  /**
   * Quantity change
   */
  function changeQuantity(delta) {
    const qtyInput = document.getElementById('quantity');
    const newValue = Math.max(1, parseInt(qtyInput.value) + delta);
    qtyInput.value = newValue;
    updateSubmitButton();
  }
  
  /**
   * Update submit button state
   */
  function updateSubmitButton() {
    const submitBtn = document.getElementById('submit-btn');
    
    // Required fields
    const hasFiles = selectedFiles.length > 0;
    const hasMaterial = document.getElementById('material').value;
    const hasEmail = document.getElementById('customer-email').value;
    
    submitBtn.disabled = !(hasFiles && hasMaterial && hasEmail);
  }
  
  /**
   * Submit RFQ
   */
  async function submitQuote() {
    if (selectedFiles.length === 0) {
      showError('Please upload your files first.');
      return;
    }
    
    const submitBtn = document.getElementById('submit-btn');
    const btnText = document.getElementById('btn-text');
    const btnLoading = document.getElementById('btn-loading');
    
    // Á¶ÅÁî®ÊåâÈíÆ
    submitBtn.disabled = true;
    btnText.style.display = 'none';
    btnLoading.style.display = 'inline';
    
    try {
      // Collect form data
      const formData = getFormData();
      
      // Validate required fields
      if (!formData.material || !formData.customerEmail) {
        throw new Error('Please complete all required fields.');
      }
      
      // ÂáÜÂ§áÊâÄÊúâÊñá‰ª∂Êï∞ÊçÆ
      const mainFile = selectedFiles.find(f => is3DFile(f.name)) || selectedFiles[0];
      const mainFileData = await readFileAsBase64(mainFile);
      
      // ÂáÜÂ§áÊâÄÊúâÊñá‰ª∂ÁöÑÊï∞ÊçÆ
      const allFilesData = [];
      for (const file of selectedFiles) {
        const fileData = await readFileAsBase64(file);
        allFilesData.push({
          name: file.name,
          size: file.size,
          type: file.type,
          data: fileData
        });
      }
      
       // Submit to API
       console.log('Submitting RFQ:', {
         fileName: mainFile.name,
         customerEmail: formData.customerEmail,
         customerName: formData.customerName,
         quantity: parseInt(formData.quantity),
         material: formData.material,
         color: formData.color,
         precision: formData.precision,
         tolerance: formData.tolerance,
         roughness: formData.roughness,
         hasThread: formData.hasThread,
         hasAssembly: formData.hasAssembly,
         scale: formData.scale,
         note: formData.note,
         allFiles: selectedFiles.map(f => f.name),
         fileCount: selectedFiles.length
       });
       
       const response = await fetch(`${API_BASE}/submit-quote-real`, {
         method: 'POST',
         headers: {
           'Content-Type': 'application/json'
         },
         body: JSON.stringify({
           fileName: mainFile.name,
           fileUrl: mainFileData, // ‰∏ªÊñá‰ª∂Êï∞ÊçÆ
           customerEmail: formData.customerEmail,
           customerName: formData.customerName,
           quantity: parseInt(formData.quantity),
           material: formData.material,
           color: formData.color,
           precision: formData.precision,
           tolerance: formData.tolerance,
           roughness: formData.roughness,
           hasThread: formData.hasThread,
           hasAssembly: formData.hasAssembly,
           scale: formData.scale,
           note: formData.note,
           allFiles: allFilesData, // ÂèëÈÄÅÊâÄÊúâÊñá‰ª∂Êï∞ÊçÆ
           lineItems: [{
            customAttributes: [
              { key: 'Material', value: formData.material },
              { key: 'Color / Finish', value: formData.color },
              { key: 'Precision', value: formData.precision },
              { key: 'Tolerance Standard', value: formData.tolerance },
              { key: 'Surface Roughness', value: formData.roughness },
              { key: 'Threads', value: formData.hasThread ? 'Yes' : 'No' },
              { key: 'Assembly Features', value: formData.hasAssembly ? 'Yes' : 'No' },
              { key: 'Scale', value: formData.scale + '%' },
              { key: 'Notes', value: formData.note || '' },
              { key: 'Uploaded File Count', value: selectedFiles.length.toString() },
              { key: 'File List', value: selectedFiles.map(f => f.name).join(', ') },
              ...selectedFiles.map((file, index) => ({
                key: `File ${index + 1} Name`,
                value: file.name
              }))
            ]
           }]
         })
       });
       
      console.log('API response status:', response.status);
      console.log('API response headers:', response.headers);
      
      const result = await response.json();
      
      if (response.ok && result.success) {
        quoteResult = result;
        showSuccess(result);
      } else {
        throw new Error(result.message || result.error || 'Submission failed');
      }
      
    } catch (error) {
      console.error('RFQ submission failed:', error);
      showError(error.message);
    } finally {
      submitBtn.disabled = false;
      btnText.style.display = 'inline';
      btnLoading.style.display = 'none';
    }
  }
  
  /**
   * Get form data
   */
  function getFormData() {
    const form = document.getElementById('quote-form');
    const formData = new FormData(form);
    
    return {
      unit: formData.get('unit'),
      material: formData.get('material'),
      color: formData.get('color'),
      precision: formData.get('precision'),
      tolerance: formData.get('tolerance'),
      roughness: formData.get('roughness'),
      hasThread: formData.get('hasThread'),
      hasAssembly: formData.get('hasAssembly'),
      scale: formData.get('scale'),
      quantity: formData.get('quantity'),
      customerName: formData.get('customer-name'),
      customerEmail: formData.get('customer-email'),
      note: formData.get('note')
    };
  }
  
  /**
   * Is 3D file
   */
  function is3DFile(fileName) {
    const ext = fileName.toLowerCase().split('.').pop();
    return ['step', 'stp', 'stl', 'obj', '3ds', 'fbx', 'dae', 'gltf', 'glb'].includes(ext);
  }
  
  /**
   * Read file as Base64
   */
  function readFileAsBase64(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = () => resolve(reader.result);
      reader.onerror = reject;
      reader.readAsDataURL(file);
    });
  }
  
  /**
   * Show success message
   */
  function showSuccess(result) {
    const successMessage = document.getElementById('success-message');
    const successText = document.getElementById('success-text');
    
    successText.innerHTML = `
      Quote ID: <strong>${result.quoteId}</strong><br>
      ${result.message || 'We‚Äôll review your files and email you a quote shortly.'}
    `;
    
    successMessage.style.display = 'block';
  }
  
  /**
   * View quote
   */
  function viewQuote() {
    if (quoteResult && quoteResult.viewUrl) {
      window.location.href = quoteResult.viewUrl;
    }
  }
  
  /**
   * Close success message
   */
  function closeSuccessMessage() {
    const successMessage = document.getElementById('success-message');
    successMessage.style.display = 'none';
    
    // Reset form
    document.getElementById('quote-form').reset();
    selectedFiles = [];
    updateFilePreview();
    updateSubmitButton();
    hideError();
  }
  
  /**
   * Show error message
   */
  function showError(message) {
    const errorMessage = document.getElementById('error-message');
    const errorText = document.getElementById('error-text');
    
    errorText.textContent = message;
    errorMessage.style.display = 'block';
  }
  
  /**
   * Hide error message
   */
  function hideError() {
    document.getElementById('error-message').style.display = 'none';
  }
  
  /**
   * Format file size
   */
  function formatFileSize(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
  }
  
  /**
   * Get customer email (Shopify)
   */
  function getCustomerEmail() {
    if (window.Shopify && window.Shopify.customer && window.Shopify.customer.email) {
      return window.Shopify.customer.email;
    }
    return '';
  }
  
  /**
   * Get customer name (Shopify)
   */
  function getCustomerName() {
    if (window.Shopify && window.Shopify.customer) {
      const customer = window.Shopify.customer;
      if (customer.firstName && customer.lastName) {
        return `${customer.firstName} ${customer.lastName}`;
      } else if (customer.firstName) {
        return customer.firstName;
      }
    }
    return '';
  }
</script>
